var SdenvExtend=function(){function t(t,e){return t===e||t!=t&&e!=e}function e(e,n){for(var r=e.length;r--;)if(t(e[r][0],n))return r;return-1}var n=Array.prototype.splice;function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}r.prototype.clear=function(){this.__data__=[],this.size=0},r.prototype.delete=function(t){var r=this.__data__,o=e(r,t);return!(o<0)&&(o==r.length-1?r.pop():n.call(r,o,1),--this.size,!0)},r.prototype.get=function(t){var n=this.__data__,r=e(n,t);return r<0?void 0:n[r][1]},r.prototype.has=function(t){return e(this.__data__,t)>-1},r.prototype.set=function(t,n){var r=this.__data__,o=e(r,t);return o<0?(++this.size,r.push([t,n])):r[o][1]=n,this};var o="object"==typeof global&&global&&global.Object===Object&&global,i="object"==typeof self&&self&&self.Object===Object&&self,s=o||i||Function("return this")(),a=s.Symbol,c=Object.prototype,u=c.hasOwnProperty,l=c.toString,f=a?a.toStringTag:void 0;var p=Object.prototype.toString;var d="[object Null]",h="[object Undefined]",g=a?a.toStringTag:void 0;function y(t){return null==t?void 0===t?h:d:g&&g in Object(t)?function(t){var e=u.call(t,f),n=t[f];try{t[f]=void 0;var r=!0}catch(t){}var o=l.call(t);return r&&(e?t[f]=n:delete t[f]),o}(t):function(t){return p.call(t)}(t)}function v(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var m="[object AsyncFunction]",b="[object Function]",w="[object GeneratorFunction]",_="[object Proxy]";function j(t){if(!v(t))return!1;var e=y(t);return e==b||e==w||e==m||e==_}var O,T=s["__core-js_shared__"],x=(O=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||""))?"Symbol(src)_1."+O:"";var P=Function.prototype.toString;function S(t){if(null!=t){try{return P.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var $=/^\[object .+?Constructor\]$/,E=Function.prototype,R=Object.prototype,A=E.toString,N=R.hasOwnProperty,D=RegExp("^"+A.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function L(t){return!(!v(t)||(e=t,x&&x in e))&&(j(t)?D:$).test(S(t));var e}function F(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return L(n)?n:void 0}var k=F(s,"Map"),I=F(Object,"create");var M=Object.prototype.hasOwnProperty;var C=Object.prototype.hasOwnProperty;function U(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function z(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function K(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}U.prototype.clear=function(){this.__data__=I?I(null):{},this.size=0},U.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},U.prototype.get=function(t){var e=this.__data__;if(I){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return M.call(e,t)?e[t]:void 0},U.prototype.has=function(t){var e=this.__data__;return I?void 0!==e[t]:C.call(e,t)},U.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=I&&void 0===e?"__lodash_hash_undefined__":e,this},K.prototype.clear=function(){this.size=0,this.__data__={hash:new U,map:new(k||r),string:new U}},K.prototype.delete=function(t){var e=z(this,t).delete(t);return this.size-=e?1:0,e},K.prototype.get=function(t){return z(this,t).get(t)},K.prototype.has=function(t){return z(this,t).has(t)},K.prototype.set=function(t,e){var n=z(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function H(t){var e=this.__data__=new r(t);this.size=e.size}H.prototype.clear=function(){this.__data__=new r,this.size=0},H.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},H.prototype.get=function(t){return this.__data__.get(t)},H.prototype.has=function(t){return this.__data__.has(t)},H.prototype.set=function(t,e){var n=this.__data__;if(n instanceof r){var o=n.__data__;if(!k||o.length<199)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new K(o)}return n.set(t,e),this.size=n.size,this};var B=function(){try{var t=F(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();function V(t,e,n){"__proto__"==e&&B?B(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function W(e,n,r){(void 0!==r&&!t(e[n],r)||void 0===r&&!(n in e))&&V(e,n,r)}var q,G=function(t,e,n){for(var r=-1,o=Object(t),i=n(t),s=i.length;s--;){var a=i[q?s:++r];if(!1===e(o[a],a,o))break}return t},J="object"==typeof exports&&exports&&!exports.nodeType&&exports,Y=J&&"object"==typeof module&&module&&!module.nodeType&&module,X=Y&&Y.exports===J?s.Buffer:void 0,Q=X?X.allocUnsafe:void 0;var Z=s.Uint8Array;function tt(t,e){var n,r,o=e?(n=t.buffer,r=new n.constructor(n.byteLength),new Z(r).set(new Z(n)),r):t.buffer;return new t.constructor(o,t.byteOffset,t.length)}var et=Object.create,nt=function(){function t(){}return function(e){if(!v(e))return{};if(et)return et(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function rt(t,e){return function(n){return t(e(n))}}var ot=rt(Object.getPrototypeOf,Object),it=Object.prototype;function st(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||it)}function at(t){return null!=t&&"object"==typeof t}function ct(t){return at(t)&&"[object Arguments]"==y(t)}var ut=Object.prototype,lt=ut.hasOwnProperty,ft=ut.propertyIsEnumerable,pt=ct(function(){return arguments}())?ct:function(t){return at(t)&&lt.call(t,"callee")&&!ft.call(t,"callee")},dt=Array.isArray,ht=9007199254740991;function gt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=ht}function yt(t){return null!=t&&gt(t.length)&&!j(t)}var vt="object"==typeof exports&&exports&&!exports.nodeType&&exports,mt=vt&&"object"==typeof module&&module&&!module.nodeType&&module,bt=mt&&mt.exports===vt?s.Buffer:void 0,wt=(bt?bt.isBuffer:void 0)||function(){return!1},_t="[object Object]",jt=Function.prototype,Ot=Object.prototype,Tt=jt.toString,xt=Ot.hasOwnProperty,Pt=Tt.call(Object);var St={};function $t(t){return function(e){return t(e)}}St["[object Float32Array]"]=St["[object Float64Array]"]=St["[object Int8Array]"]=St["[object Int16Array]"]=St["[object Int32Array]"]=St["[object Uint8Array]"]=St["[object Uint8ClampedArray]"]=St["[object Uint16Array]"]=St["[object Uint32Array]"]=!0,St["[object Arguments]"]=St["[object Array]"]=St["[object ArrayBuffer]"]=St["[object Boolean]"]=St["[object DataView]"]=St["[object Date]"]=St["[object Error]"]=St["[object Function]"]=St["[object Map]"]=St["[object Number]"]=St["[object Object]"]=St["[object RegExp]"]=St["[object Set]"]=St["[object String]"]=St["[object WeakMap]"]=!1;var Et="object"==typeof exports&&exports&&!exports.nodeType&&exports,Rt=Et&&"object"==typeof module&&module&&!module.nodeType&&module,At=Rt&&Rt.exports===Et&&o.process,Nt=function(){try{var t=Rt&&Rt.require&&Rt.require("util").types;return t||At&&At.binding&&At.binding("util")}catch(t){}}(),Dt=Nt&&Nt.isTypedArray,Lt=Dt?$t(Dt):function(t){return at(t)&&gt(t.length)&&!!St[y(t)]};function Ft(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var kt=Object.prototype.hasOwnProperty;function It(e,n,r){var o=e[n];kt.call(e,n)&&t(o,r)&&(void 0!==r||n in e)||V(e,n,r)}var Mt=9007199254740991,Ct=/^(?:0|[1-9]\d*)$/;function Ut(t,e){var n=typeof t;return!!(e=null==e?Mt:e)&&("number"==n||"symbol"!=n&&Ct.test(t))&&t>-1&&t%1==0&&t<e}var zt=Object.prototype.hasOwnProperty;function Kt(t,e){var n=dt(t),r=!n&&pt(t),o=!n&&!r&&wt(t),i=!n&&!r&&!o&&Lt(t),s=n||r||o||i,a=s?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],c=a.length;for(var u in t)!e&&!zt.call(t,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ut(u,c))||a.push(u);return a}var Ht=Object.prototype.hasOwnProperty;function Bt(t){if(!v(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=st(t),n=[];for(var r in t)("constructor"!=r||!e&&Ht.call(t,r))&&n.push(r);return n}function Vt(t){return yt(t)?Kt(t,!0):Bt(t)}function Wt(t){return function(t,e,n,r){var o=!n;n||(n={});for(var i=-1,s=e.length;++i<s;){var a=e[i],c=r?r(n[a],t[a],a,n,t):void 0;void 0===c&&(c=t[a]),o?V(n,a,c):It(n,a,c)}return n}(t,Vt(t))}function qt(t,e,n,r,o,i,s){var a=Ft(t,n),c=Ft(e,n),u=s.get(c);if(u)W(t,n,u);else{var l,f=i?i(a,c,n+"",t,e,s):void 0,p=void 0===f;if(p){var d=dt(c),h=!d&&wt(c),g=!d&&!h&&Lt(c);f=c,d||h||g?dt(a)?f=a:at(l=a)&&yt(l)?f=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}(a):h?(p=!1,f=function(t,e){if(e)return t.slice();var n=t.length,r=Q?Q(n):new t.constructor(n);return t.copy(r),r}(c,!0)):g?(p=!1,f=tt(c,!0)):f=[]:function(t){if(!at(t)||y(t)!=_t)return!1;var e=ot(t);if(null===e)return!0;var n=xt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Tt.call(n)==Pt}(c)||pt(c)?(f=a,pt(a)?f=Wt(a):v(a)&&!j(a)||(f=function(t){return"function"!=typeof t.constructor||st(t)?{}:nt(ot(t))}(c))):p=!1}p&&(s.set(c,f),o(f,c,r,i,s),s.delete(c)),W(t,n,f)}}function Gt(t,e,n,r,o){t!==e&&G(e,(function(i,s){if(o||(o=new H),v(i))qt(t,e,s,n,Gt,r,o);else{var a=r?r(Ft(t,s),i,s+"",t,e,o):void 0;void 0===a&&(a=i),W(t,s,a)}}),Vt)}function Jt(t){return t}var Yt=Math.max;var Xt=B?function(t,e){return B(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:Jt,Qt=Xt,Zt=Date.now;var te,ee,ne,re=(te=Qt,ee=0,ne=0,function(){var t=Zt(),e=16-(t-ne);if(ne=t,e>0){if(++ee>=800)return arguments[0]}else ee=0;return te.apply(void 0,arguments)});function oe(t,e){return re(function(t,e,n){return e=Yt(void 0===e?t.length-1:e,0),function(){for(var r=arguments,o=-1,i=Yt(r.length-e,0),s=Array(i);++o<i;)s[o]=r[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=r[o];return a[e]=n(s),function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(t,this,a)}}(t,e,Jt),t+"")}var ie,se=(ie=function(t,e,n){Gt(t,e,n)},oe((function(e,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(i=ie.length>3&&"function"==typeof i?(o--,i):void 0,s&&function(e,n,r){if(!v(r))return!1;var o=typeof n;return!!("number"==o?yt(r)&&Ut(n,r.length):"string"==o&&n in r)&&t(r[n],e)}(n[0],n[1],s)&&(i=o<3?void 0:i,o=1),e=Object(e);++r<o;){var a=n[r];a&&ie(e,a,r,i)}return e})));const ae={adapt:{},tools:{},utils:{},config:{proxyOpen:!1,randomReturn:void 0,randomFixed:!1,timeInterval:void 0,timeTimeout:void 0,isNode:"undefined"==typeof window,windowGetterUndefinedKeys:["_runScripts","_globalObject"],windowGetterErrorKeys:["process"],windowGetterOwnKeys:[Symbol.toStringTag,"addEventListener","removeEventListener","dispatchEvent"],windowGetterWinKeys:["window","top","self","frames","globalThis"]},memory:{runinfo:{start:(new Date).getTime(),isDied:!1},timeout:null,SdenvExtend:null},cache:{dynamicCode:[],runloop:{},runsArr:[],runsObj:[],runtime:{},monitor:{},timeoutIdx:0,intervalIdx:0},datas:{dateAndRandom:{}}};function ce(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}var ue="[object Symbol]";function le(t){return"symbol"==typeof t||at(t)&&y(t)==ue}var fe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pe=/^\w*$/;function de(t,e){if(dt(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!le(t))||(pe.test(t)||!fe.test(t)||null!=e&&t in Object(e))}var he="Expected a function";function ge(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(he);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var s=t.apply(this,r);return n.cache=i.set(o,s)||i,s};return n.cache=new(ge.Cache||K),n}ge.Cache=K;var ye=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ve=/\\(\\)?/g,me=function(t){var e=ge(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ye,(function(t,n,r,o){e.push(r?o.replace(ve,"$1"):n||t)})),e})),be=1/0,we=a?a.prototype:void 0,_e=we?we.toString:void 0;function je(t){if("string"==typeof t)return t;if(dt(t))return ce(t,je)+"";if(le(t))return _e?_e.call(t):"";var e=t+"";return"0"==e&&1/t==-be?"-0":e}function Oe(t){return null==t?"":je(t)}function Te(t,e){return dt(t)?t:de(t,e)?[t]:me(Oe(t))}var xe=1/0;function Pe(t){if("string"==typeof t||le(t))return t;var e=t+"";return"0"==e&&1/t==-xe?"-0":e}function Se(t,e){for(var n=0,r=(e=Te(e,t)).length;null!=t&&n<r;)t=t[Pe(e[n++])];return n&&n==r?t:void 0}function $e(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new K;++e<n;)this.add(t[e])}function Ee(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}$e.prototype.add=$e.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},$e.prototype.has=function(t){return this.__data__.has(t)};var Re=1,Ae=2;function Ne(t,e,n,r,o,i){var s=n&Re,a=t.length,c=e.length;if(a!=c&&!(s&&c>a))return!1;var u=i.get(t),l=i.get(e);if(u&&l)return u==e&&l==t;var f=-1,p=!0,d=n&Ae?new $e:void 0;for(i.set(t,e),i.set(e,t);++f<a;){var h=t[f],g=e[f];if(r)var y=s?r(g,h,f,e,t,i):r(h,g,f,t,e,i);if(void 0!==y){if(y)continue;p=!1;break}if(d){if(!Ee(e,(function(t,e){if(s=e,!d.has(s)&&(h===t||o(h,t,n,r,i)))return d.push(e);var s}))){p=!1;break}}else if(h!==g&&!o(h,g,n,r,i)){p=!1;break}}return i.delete(t),i.delete(e),p}function De(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function Le(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var Fe=1,ke=2,Ie="[object Boolean]",Me="[object Date]",Ce="[object Error]",Ue="[object Map]",ze="[object Number]",Ke="[object RegExp]",He="[object Set]",Be="[object String]",Ve="[object Symbol]",We="[object ArrayBuffer]",qe="[object DataView]",Ge=a?a.prototype:void 0,Je=Ge?Ge.valueOf:void 0;var Ye=Object.prototype.propertyIsEnumerable,Xe=Object.getOwnPropertySymbols,Qe=Xe?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var s=t[n];e(s,n,t)&&(i[o++]=s)}return i}(Xe(t),(function(e){return Ye.call(t,e)})))}:function(){return[]},Ze=Qe,tn=rt(Object.keys,Object),en=Object.prototype.hasOwnProperty;function nn(t){return yt(t)?Kt(t):function(t){if(!st(t))return tn(t);var e=[];for(var n in Object(t))en.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}function rn(t){return function(t,e,n){var r=e(t);return dt(t)?r:function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}(r,n(t))}(t,nn,Ze)}var on=1,sn=Object.prototype.hasOwnProperty;var an=F(s,"DataView"),cn=F(s,"Promise"),un=F(s,"Set"),ln=F(s,"WeakMap"),fn="[object Map]",pn="[object Promise]",dn="[object Set]",hn="[object WeakMap]",gn="[object DataView]",yn=S(an),vn=S(k),mn=S(cn),bn=S(un),wn=S(ln),_n=y;(an&&_n(new an(new ArrayBuffer(1)))!=gn||k&&_n(new k)!=fn||cn&&_n(cn.resolve())!=pn||un&&_n(new un)!=dn||ln&&_n(new ln)!=hn)&&(_n=function(t){var e=y(t),n="[object Object]"==e?t.constructor:void 0,r=n?S(n):"";if(r)switch(r){case yn:return gn;case vn:return fn;case mn:return pn;case bn:return dn;case wn:return hn}return e});var jn=_n,On=1,Tn="[object Arguments]",xn="[object Array]",Pn="[object Object]",Sn=Object.prototype.hasOwnProperty;function $n(e,n,r,o,i,s){var a=dt(e),c=dt(n),u=a?xn:jn(e),l=c?xn:jn(n),f=(u=u==Tn?Pn:u)==Pn,p=(l=l==Tn?Pn:l)==Pn,d=u==l;if(d&&wt(e)){if(!wt(n))return!1;a=!0,f=!1}if(d&&!f)return s||(s=new H),a||Lt(e)?Ne(e,n,r,o,i,s):function(e,n,r,o,i,s,a){switch(r){case qe:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case We:return!(e.byteLength!=n.byteLength||!s(new Z(e),new Z(n)));case Ie:case Me:case ze:return t(+e,+n);case Ce:return e.name==n.name&&e.message==n.message;case Ke:case Be:return e==n+"";case Ue:var c=De;case He:var u=o&Fe;if(c||(c=Le),e.size!=n.size&&!u)return!1;var l=a.get(e);if(l)return l==n;o|=ke,a.set(e,n);var f=Ne(c(e),c(n),o,i,s,a);return a.delete(e),f;case Ve:if(Je)return Je.call(e)==Je.call(n)}return!1}(e,n,u,r,o,i,s);if(!(r&On)){var h=f&&Sn.call(e,"__wrapped__"),g=p&&Sn.call(n,"__wrapped__");if(h||g){var y=h?e.value():e,v=g?n.value():n;return s||(s=new H),i(y,v,r,o,s)}}return!!d&&(s||(s=new H),function(t,e,n,r,o,i){var s=n&on,a=rn(t),c=a.length;if(c!=rn(e).length&&!s)return!1;for(var u=c;u--;){var l=a[u];if(!(s?l in e:sn.call(e,l)))return!1}var f=i.get(t),p=i.get(e);if(f&&p)return f==e&&p==t;var d=!0;i.set(t,e),i.set(e,t);for(var h=s;++u<c;){var g=t[l=a[u]],y=e[l];if(r)var v=s?r(y,g,l,e,t,i):r(g,y,l,t,e,i);if(!(void 0===v?g===y||o(g,y,n,r,i):v)){d=!1;break}h||(h="constructor"==l)}if(d&&!h){var m=t.constructor,b=e.constructor;m==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof m&&m instanceof m&&"function"==typeof b&&b instanceof b||(d=!1)}return i.delete(t),i.delete(e),d}(e,n,r,o,i,s))}function En(t,e,n,r,o){return t===e||(null==t||null==e||!at(t)&&!at(e)?t!=t&&e!=e:$n(t,e,n,r,En,o))}var Rn=1,An=2;function Nn(t){return t==t&&!v(t)}function Dn(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}function Ln(t){var e=function(t){for(var e=nn(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,Nn(o)]}return e}(t);return 1==e.length&&e[0][2]?Dn(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,r){var o=n.length,i=o,s=!r;if(null==t)return!i;for(t=Object(t);o--;){var a=n[o];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var c=(a=n[o])[0],u=t[c],l=a[1];if(s&&a[2]){if(void 0===u&&!(c in t))return!1}else{var f=new H;if(r)var p=r(u,l,c,t,e,f);if(!(void 0===p?En(l,u,Rn|An,r,f):p))return!1}}return!0}(n,t,e)}}function Fn(t,e,n){var r=null==t?void 0:Se(t,e);return void 0===r?n:r}function kn(t,e){return null!=t&&e in Object(t)}function In(t,e){return null!=t&&function(t,e,n){for(var r=-1,o=(e=Te(e,t)).length,i=!1;++r<o;){var s=Pe(e[r]);if(!(i=null!=t&&n(t,s)))break;t=t[s]}return i||++r!=o?i:!!(o=null==t?0:t.length)&&gt(o)&&Ut(s,o)&&(dt(t)||pt(t))}(t,e,kn)}var Mn=1,Cn=2;function Un(t){return de(t)?(e=Pe(t),function(t){return null==t?void 0:t[e]}):function(t){return function(e){return Se(e,t)}}(t);var e}function zn(t){return"function"==typeof t?t:null==t?Jt:"object"==typeof t?dt(t)?(e=t[0],n=t[1],de(e)&&Nn(n)?Dn(Pe(e),n):function(t){var r=Fn(t,e);return void 0===r&&r===n?In(t,e):En(n,r,Mn|Cn)}):Ln(t):Un(t);var e,n}var Kn=function(t,e){return function(n,r){if(null==n)return n;if(!yt(n))return t(n,r);for(var o=n.length,i=e?o:-1,s=Object(n);(e?i--:++i<o)&&!1!==r(s[i],i,s););return n}}((function(t,e){return t&&G(t,e,nn)}));function Hn(t,e){if(t!==e){var n=void 0!==t,r=null===t,o=t==t,i=le(t),s=void 0!==e,a=null===e,c=e==e,u=le(e);if(!a&&!u&&!i&&t>e||i&&s&&c&&!a&&!u||r&&s&&c||!n&&c||!o)return 1;if(!r&&!i&&!u&&t<e||u&&n&&o&&!r&&!i||a&&n&&o||!s&&o||!c)return-1}return 0}function Bn(t,e,n){e=e.length?ce(e,(function(t){return dt(t)?function(e){return Se(e,1===t.length?t[0]:t)}:t})):[Jt];var r=-1;e=ce(e,$t(zn));var o=function(t,e){var n=-1,r=yt(t)?Array(t.length):[];return Kn(t,(function(t,o,i){r[++n]=e(t,o,i)})),r}(t,(function(t,n,o){return{criteria:ce(e,(function(e){return e(t)})),index:++r,value:t}}));return function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(o,(function(t,e){return function(t,e,n){for(var r=-1,o=t.criteria,i=e.criteria,s=o.length,a=n.length;++r<s;){var c=Hn(o[r],i[r]);if(c)return r>=a?c:c*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)}))}function Vn(){const t=this,e=t.getTools("addUtil"),n={},r=t.memory.window,o=t.cache.runloop={current:1};let i=!1;e(((e,s,a,c="",u=0)=>{const l=[],f=o.current++;o[e]||(o[e]=[]);const p={idx:s,name:a,data:l,current:f,idxs:[],list:Array.isArray(c)?c.join():c,lens:u||(Array.isArray(c)?c.length:-1),pre:{current:n.cur,curloop:n.num},param:{}};return n.loop&&(n.loop.param[n.loop.data.length-1]={next:f}),o[e].push(p),i&&r.console.log(`【RUN TASK】current：${f}`),{addLoop:(e,r,o)=>(p.data.push(r),p.idxs.push(e),Object.assign(n,{key:o,cur:f,num:l.length,loop:p}),(...e)=>{i&&console.log([`(${f}，${l.length})`,...e.map((e=>t.tools.compressText(e,200)))].join(" ==== "))}),curLoop:()=>l.length,current:f,loopobj:p,openLog:()=>i=!0,closeLog:()=>i=!1,isLog:()=>i}}),"initLoop"),e((()=>({...n})),"getPreLoop"),e((()=>i),"getLogLoop"),e((()=>i=!1),"closeLogLoop"),e((()=>i=!0),"openLogLoop"),e((t=>{const e=JSON.parse(JSON.stringify(o)),n={};if(Object.entries(e).forEach((([t,e])=>{var r,o,i,s;Array.isArray(e)&&(n[t]={},e.forEach((e=>{e.data.forEach((e=>{void 0===n[t][e]&&(n[t][e]=0),n[t][e]++})),e.data=e.data.join(),e.idxs=e.idxs.join()})),n[t]=(r=Object.entries(n[t]).map((([t,e])=>({code:t,num:e}))),o="num",i="desc",null==r?[]:(dt(o)||(o=null==o?[]:[o]),dt(i=s?void 0:i)||(i=null==i?[]:[i]),Bn(r,o,i))))})),t){const n=JSON.stringify(e);"function"==typeof t?(t(n),console.log("运行时数据复制成功")):console.log(n)}return{ascii:n,...e}}),"getLoopData")}function Wn(t,e,n){Object.defineProperty(t,e,{configurable:!1,enumerable:!0,writable:!1,value:n})}let qn=Function.toString;const Gn=[],Jn=function(){return Gn.includes(this.name)?`function ${this.name||""}() { [native code] }`:qn.call(this)},Yn=function(t,e,n){if(t)return"string"==typeof e?Object.defineProperty(t,"name",{value:e}):"number"==typeof e&&(n=e),"number"==typeof n&&Object.defineProperty(t,"length",{value:n}),Gn.push(t.name),Object.defineProperty(t,"toString",{enumerable:!1,configurable:!0,writable:!0,value:Jn}),t},Xn=function(t,e){return Object.defineProperty(t,"name",{configurable:!0,enumerable:!1,writable:!1,value:e}),t},Qn=function(t,e,n){return Xn(t,e),Yn(t,e,n),t};Yn(Jn,"toString");const Zn=function(t,e){return Object.defineProperty(t,"toString",{enumerable:!1,configurable:!0,writable:!0,value:()=>`[object ${e}]`}),t},tr=function(t,e){return Object.defineProperty(t,Symbol.toStringTag,{configurable:!0,enumerable:!1,writable:!1,value:e}),t},er=function(t,e){return tr(t,e),Zn(t,e),t};const nr=function(){this.cache=null,this.add=t=>{if(!this.cache)return!1;this.cache.task.includes(t)||this.cache.task.push(t)},this.set=t=>this.cache=t,this.get=()=>this.cache,this.getTime=()=>!!this.cache&&this.cache.time,this.getTask=t=>!!this.cache&&("number"==typeof t?this.cache.task[t]:this.cache.task),this.clear=()=>this.cache=null};class rr{constructor(t){this.sdenv=t,this.index=[],this.timeouts={},this.lastOp=t.memory.runinfo.start,this.isLock=!1,this.id=0,this.currentTask=new nr}addTimeout(t,e,n="timeout",r=this.index.length){const{sdenv:o}=this;let i=(new o.memory.Date).getTime()-o.memory.runinfo.start+e;const s={func:t,type:n,flag:0,time:e,expect_time:i,real_time:null,index:r,id:this.id++};return this.index[r]?this.index[r]=s:this.index.push(s),0===e&&this.currentTask.get()?(i=this.currentTask.getTime(),this.timeouts[i].push(s),this.currentTask.add(s)):(void 0===this.timeouts[i]&&(this.timeouts[i]=[]),this.timeouts[i].push(s),this.sdenv.tools.isAlive()&&this.exec()),r}addInterval(t,e,n=void 0){const r=this;return n=this.addTimeout((function(){try{t()}catch(t){console.error(t)}finally{-1!==r.index[n].flag&&r.addInterval(t,e,n)}}),e,"interval",n)}remove(t){if("number"!=typeof t||!this.index[t])return!1;if(0===this.index[t].flag)this.index[t].flag=-1;else{if([-1,2].includes(this.index[t].flag))return;if(1===this.index[t].flag)return!1}}exec(){this.isLock||(this.isLock=!0,this.sdenv.memory.setTimeout((()=>{this.isLock=!1,this.run()}),0))}run(){const{sdenv:t}=this,e=t.memory.window,n=Object.keys(this.timeouts).filter((e=>!(Number(e)+t.memory.runinfo.start<=this.lastOp)));if(0===n.length)return!1;this.lastOp=Number(n[0])+t.memory.runinfo.start,this.currentTask.set({task:this.timeouts[n[0]],time:n[0]});for(let r=0;this.currentTask.getTask(r);r++){const o=this.currentTask.getTask(r);if(this.sdenv.tools.isDied()||-1===o.flag)return;const i=o.func.param?JSON.stringify(o.func.param):t.tools.compressText(o.func.toString());e.console.log(`【TIMEOUT RUN】执行程序时间${n[0]}处${o.type}回调，延时：${o.time}，编号：${o.id}，方法：${i}`),o.flag=1,o.real_time=(new t.memory.Date).getTime()-t.memory.runinfo.start;try{o.func(),e.console.log(`【TIMEOUT RUNED】执行程序时间${n[0]}处${o.type}回调，延时：${o.time}，编号：${o.id}，方法：${i}`)}catch(t){console.error(t)}o.flag=2}this.currentTask.clear(),this.sdenv.tools.isDied()||(n.length>1?this.run():this.exec())}}function or(){this.memory.timeout||(this.memory.timeout=new rr(this))}var ir=Object.freeze({__proto__:null,_setFuncInit:function(t){Yn(Jn,"toString"),t.Function.prototype.toString=Jn,Jn.__proto__=t.Function.prototype},addConstant:Wn,addConstants:function(t,e){for(const n in e){Wn(t,n,e[n])}},addInterval:function(t,e){return or.call(this),this.memory.timeout.addInterval(t,e)},addRuntimeData:function(t,e,n){this.cache.runtime[t]||(this.cache.runtime[t]={});const r=this.cache.runtime[t];return r[e]||(r[e]=[]),r[e].push(n),n},addTimeout:function(t,e){return or.call(this),this.memory.timeout.addTimeout(t,Number(e||0),"timeout")},addUtil:function(t,e){return this.utils[e||t.name]=t.bind(this),t},compressText:function(t,e=100){return"string"!=typeof t&&(t=`${t}`),t.length<=e?t:t.replace(/[\n\s\r]+/g," ").slice(0,e)+"......"},delay:function(t){const e=this;return new Promise((n=>Fn(e,"memory.setTimeout",setTimeout)(n,t)))},exit:function(t){const e=this.memory.window;this.getTools("setDied")(),t.eventId&&e.dispatchEvent(new e.CustomEvent(`sdenv:${t.eventId}`,{detail:t})),e.dispatchEvent(new e.CustomEvent("sdenv:exit",{detail:t})),t.url&&e.onbeforeunload?.(t.url)},getMonitor:function(t){return t?this.cache.monitor[t]:this.cache.monitor},getNativeProto:function(t,e,n={}){const r=Qn((()=>{throw new TypeError("Illegal constructor")}),t);return[r,er({__proto__:r,...n},t)]},getRuntimeData:function(t,e){return Fn(this,["cache.runtime",t,e].filter((t=>void 0!==t)).join("."))},getUtil:function(t){return this.utils[t]},isAlive:function(){return!this.memory.runinfo.isDied},isDied:function(){return this.memory.runinfo.isDied},isWindow:function(t){return t&&t===t.window},mixin:function(t,e,n=[]){const r=Reflect.ownKeys(e);for(let o=0;o<r.length;++o)r[o]in t&&!n.includes(r[o])||Object.defineProperty(t,r[o],Object.getOwnPropertyDescriptor(e,r[o]))},monitor:function(t,e,n={}){const r=this.memory.window,o=this.tools,{getLog:i,setLog:s,getKeys:a=[],setKeys:c=[],keys:u=[],getCb:l,setCb:f,cb:p,getParse:d=((t,e)=>e),setParse:h=((t,e)=>e),handles:g={}}=n;this.cache.monitor[e]||(this.cache.monitor[e]=[]),t.sdMonitorName=e;const y=new r.Proxy(t,{get:(t,n,o)=>(i&&r.console.log(`${e} Getting ${n}`),a.includes(n)||u.includes(n),(l||p)?.(n,e),d(n,Reflect.get(t,n,o),t)),set(t,n,i,a){const l=[r,r.Math,r.navigation].includes(i)&&i.toString?i.toString():i;return!s||Array.isArray(t)&&"length"===n||r.console.log(`${e} Setting ${n} to ${o.compressText(l)}`),c.includes(n)||u.includes(n),(f||p)?.(n,i,e),Reflect.set(t,n,h(n,i,t),a)},...g});return this.cache.monitor[e].push(y),y},monitorFunction:function(t,e,n={}){const r=this.memory.window,{log:o,isDebugger:i,cb:s}=n;this.cache.monitor[e]||(this.cache.monitor[e]=[]);const a=new r.Proxy(t,{apply(t,n,i){const a=Reflect.apply(t,n,i);return o&&r.console.log(`${e} Apply ${i}`),s?.(i,a,e),a}});return this.cache.monitor[e].push(a),a},removeInterval:function(t){return or.call(this),this.memory.timeout.remove(t)},removeTimeout:function(t){return or.call(this),this.memory.timeout.remove(t)},setDied:function(){this.memory.runinfo.isDied=!0},setFuncName:Xn,setFuncNative:Yn,setNativeFuncName:Qn,setNativeObjName:er,setObjName:tr,setObjNative:Zn,setToString:function(t){Object.defineProperty(t,"toString",{configurable:!0,enumerable:!1,writable:!1,value:Jn})},toString:Jn,wrapFunc:function(t,e,n){const r=t[e].bind(t),o=(...t)=>n(r,...t);return Yn(o,e,r.length),t[e]=o,o}});function sr(t,e={},n=0,r=[0],o=null){void 0===e._count&&(e._count=0);const{monitor:i={},...s}=((t,e={})=>{const n=Object.keys(t).map((e=>[e,typeof t[e]])),r={},o=n.filter((([t,e])=>"string"===e)).map((t=>t[0])),i=n.filter((([t,e])=>"number"===e)).map((t=>t[0])),s=n.filter((([e,n])=>"object"===n&&Array.isArray(t[e]))).map((t=>t[0]));return 1!==o.length||2!==i.length||2!==s.length?(console.error("任务树结构有变化，请手动传入！"),e):(r.taskKey=o[0],[r.lensKey,r.isResetKey]=t[i[0]]>t[i[1]]?i:i.reverse(),[r.oneKey,r.twoKey]=t[s[0]].length>t[s[1]].length?s:s.reverse(),Object.assign(e,r),e)})(t,e),{taskKey:a,oneKey:c,twoKey:u,lensKey:l,isResetKey:f}=s,p=t[a];return t.parent=o,t.str=p,t.val={},p?(t.arr=p.split("").map((t=>t.charCodeAt())),e._count>0&&(t[a]=[...t.arr])):(t.arr=[],t[a]=[]),t.idx=`${r.join(">")}-${e._count++}`,t.uid=function(t){const e=[];for(let n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return"U"+String.fromCharCode(...e).split("").map((t=>t.charCodeAt())).join("")}([n,t[l],t[f],t.arr.length,t[c].length,t[u].length].join("-")),[c,u].forEach(((o,a)=>{t[o]=t[o].map(((o,c)=>o?(sr.call(this,o,e,n+1,[...r,["one","two"][a],c],t),this.getTools("monitor")(o,o.idx,{setLog:!1,...i,parse:i.parse?(t,e)=>i.parse(t,e,o.idx,s):void 0})):o))})),t}var ar=Object.freeze({__proto__:null,parseTaskTree:function(...t){this.cache.runsObj=sr.call(this,...t),this.cache.runsArr=[]}}),cr=Object.freeze({__proto__:null,rs:ar});const ur={'!new function(){eval("this.a=1")}().a':"false"};var lr=/\s/;var fr=/^\s+/;function pr(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&lr.test(t.charAt(e)););return e}(t)+1).replace(fr,""):t}var dr=NaN,hr=/^[-+]0x[0-9a-f]+$/i,gr=/^0b[01]+$/i,yr=/^0o[0-7]+$/i,vr=parseInt;function mr(t){if("number"==typeof t)return t;if(le(t))return dr;if(v(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=v(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=pr(t);var n=gr.test(t);return n||yr.test(t)?vr(t.slice(2),n?2:8):hr.test(t)?dr:+t}var br=1/0,wr=17976931348623157e292;function _r(t){var e=function(t){return t?(t=mr(t))===br||t===-br?(t<0?-1:1)*wr:t==t?t:0:0===t?t:0}(t),n=e%1;return e==e?n?e-n:e:0}var jr=s.isFinite,Or=Math.min;var Tr=function(t){var e=Math[t];return function(t,n){if(t=mr(t),(n=null==n?0:Or(_r(n),292))&&jr(t)){var r=(Oe(t)+"e").split("e");return+((r=(Oe(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}("round");const xr=Tr(Math.random(),2),Pr={charging_success:{charging:!0,chargingTime:0,dischargingTime:1/0,level:1},discharging_success:{charging:!1,chargingTime:1/0,dischargingTime:1/0,level:1},charging_ing:{charging:!0,chargingTime:100*(1-xr)*300,dischargingTime:1/0,level:xr},discharging_ing:{charging:!1,chargingTime:1/0,dischargingTime:100*xr*443,level:xr}};function Sr(t,{datas:e}){const n=t.memory.window;if(this.sdenv=t,e&&Array.isArray(e._newdate)&&Array.isArray(e._newdate[0])&&(e._newdate=e._newdate.reduce(((t,[e,n])=>[...t,...new Array(n).fill(e)]),[])),this.data=e||{},this.data?.firstMap&&Object.values(this.data.firstMap).some((t=>!t)))throw new Error("日期首位配置错误请检查");this.runs=[],Object.assign(this,{_now:n.Date.now,_parse:n.Date.parse,_valueOf:n.Date.prototype.valueOf,_getTime:n.Date.prototype.getTime,_toString:n.Date.prototype.toString,_random:n.Math.random})}Sr.prototype.shift=function(t){const{firstMap:e}=this.data;let n=this.data[t].shift();return"number"==typeof e[t]&&(n+=e[t]),this.runs.push(n),n},Sr.prototype.wrapFun=function(t,e){const n=`_${t}`;if(!this[n])return;void 0!==e||Array.isArray(this.data[n])||(this.data[n]=[]);const r=this;return this.sdenv.getTools("setNativeFuncName")((function(){if(void 0!==e)return e;if(r.data.firstMap?.[n]){if(!r.data[n].length)throw new Error(`DateAndRandom的${n}数据不够`);return r.shift(n)}const t=r[n].call(this);return r.data[n].push(t),t}),t)},Sr.prototype.wrapClass=function(t,e){const n=this.sdenv.memory.window,r=`_${t}`;Array.isArray(this.data[r])||(this.data[r]=[]);const o=this;return this.sdenv.getTools("setNativeFuncName")(new Proxy(e,{construct(t,i,s){if(o.data.firstMap?.[r]){if(!o.data[r].length)throw new Error(`DateAndRandom的${r}数据不够`);return new e(o.shift(r))}const a=Reflect.construct(t,i,s);return o.data[r].push(n.Date.prototype.valueOf.call(a)),a},apply:(t,e,n)=>Reflect.apply(t,e,n)}),e.name||t)},Sr.prototype.getData=function(t){const e=Object.entries(this.data).reduce(((t,[e,n])=>{if("firstMap"===e||!n.length)return t;if("_random"===e)return t[e]=n,t.firstMap[e]=!0,t;const r=n[0];return t.firstMap[e]=r,t[e]="_newdate"===e?n.map((t=>t-r)).reduce(((t,e)=>(0===t.length||t[t.length-1][0]!==e?t.push([e,1]):t[t.length-1][1]+=1,t)),[]):n.map((t=>t-r)),t}),{firstMap:{}});return t&&(t(JSON.stringify(e)),console.log("日期与随机数数据复制成功")),e};var $r=Object.freeze({__proto__:null,batteryHandle:function(t){"string"==typeof t?t=Pr[t]||{}:"object"!=typeof t&&(t={}),this.memory.window.navigator.getBattery=this.getTools("setNativeFuncName")((()=>new Promise(((e,n)=>{e({onchargingchange:null,onchargingtimechange:null,ondischargingtimechange:null,onlevelchange:null,...Pr.charging_success,...t})}))),"getBattery")},connectionHandle:function(t){const e=this.memory.window;"object"!=typeof t&&(t={}),this.getTools("addConstants")(e.navigator.connection,{downlink:6.66,effectiveType:"4g",onchange:null,rtt:0,saveData:!1,...t})},cookieHandle:function(t){"object"!=typeof t&&(t={});const e=this.memory.window,n=Object.getOwnPropertyDescriptor(e.Document.prototype,"cookie").get,r=Object.getOwnPropertyDescriptor(e.Document.prototype,"cookie").set,{getLog:o,setLog:i,log:s,getCb:a,setCb:c,cb:u,parse:l=(t=>t)}=t,f={};Object.defineProperty(e.document,"cookie",{configurable:!1,enumerable:!1,get(){const t=n.call(e.document);return(o||s)&&e.console.log(`【GET COOKIE】长：${t.length} 值：${t}`),(a||u)?.(t),t},set(t){t.split(";").map((t=>t.split("=").map((t=>t.trim())))).forEach((([t])=>{t&&(void 0===f[t]?f[t]=1:f[t]++)})),(i||s)&&e.console.log(`【SET COOKIE】长：${t.length} 值：${t}`),(c||u)?.(t,f),r.call(e.document,l(t))}})},dateAndRandomHandle:function(t){"object"!=typeof t&&(t={});const e=this.memory.window,{randomReturn:n=this.config.randomReturn}=t,r=new Sr(this,t);this.getTools("addUtil")(r.getData.bind(r),"getDateData"),e.Date=r.wrapClass("newdate",e.Date),e.Date.now=r.wrapFun("now"),e.Date.parse=r.wrapFun("parse"),e.Math.random=r.wrapFun("random",n)},evalHandle:function(t){"object"!=typeof t&&(t={});const e=this.memory.window,{cb:n,log:r}=t,o=this;e.eval=this.getTools("setNativeFuncName")(new Proxy(e.eval,{apply(t,i,s){r&&e.console.log(`【EVAL APPLY】参数：${s.map((t=>o.getTools("compressText")(JSON.stringify(t))))}`);const a=s.map((t=>"string"==typeof ur[t]?ur[t]:(t.includes("debugger")&&(t=t.replace(/debugger/g,"")),t.includes("sdDebugger")&&(t=t.replace(/sdDebugger/g,"debugger")),t))),c={type:"eval",params:s,tar_params:a};return n?.(c),o.cache.dynamicCode.push({...c}),Reflect.apply(t,i,a)}}),"eval")},eventHandle:function(t){const e=this,n=this.memory.window;"object"!=typeof t&&(t={});const{addLog:r,runLog:o,log:i,addCb:s,runCb:a,cb:c,filter:u=(()=>!0)}=t;n.addEventListener=this.getTools("setNativeFuncName")(new Proxy(n.addEventListener,{apply:function(t,l,f){if(!u||!u(...f))return;const[p,d]=f,h=d.param?JSON.stringify(d.param):e.getTools("compressText")(d.toString());return(r||i)&&n.console.log(`【ADD EVENT】事件名：${p}, 方法：${h}`),(s||c)?.(...f),Reflect.apply(t,l,[p,async()=>{(a||c)?.(...f),(o||i)&&n.console.log(`【RUN EVENT】事件名：${p}, 方法：${h}`),d()}])}}),"addEventListener")},funcHandle:function(t){const e=this;"object"!=typeof t&&(t={});const n=this.memory.window,{log:r,cb:o}=t;n.Function=this.getTools("setNativeFuncName")(new Proxy(n.Function,{apply(t,i,s){const a=s.map((t=>(t.includes("debugger")&&(t=t.replace(/debugger/g,"")),t.includes("sdDebugger")&&(t=t.replace(/sdDebugger/g,"debugger")),t)));r&&n.console.log(`【FUNCTION APPLY】参数：${s.map((t=>e.getTools("compressText")(JSON.stringify(t))))}`);const c={type:"Function",params:s,tar_params:a};return o?.(c),e.cache.dynamicCode.push({...c}),Reflect.apply(t,i,a)}}),"Function"),n.Function.prototype.constructor=n.Function,this.getTools("setNativeFuncName")(n.Function.prototype,"")},indexedDBHandle:function(t){"object"!=typeof t&&(t={});const e=this.memory.window,{cb:n,log:r,ignore:o,getLog:i,setLog:s,getCb:a,setCb:c}=t,u=this;e.IDBFactory.prototype.open=this.getTools("setFuncNative")(new Proxy(e.IDBFactory.prototype.open,{apply(t,l,f){r&&e.console.log(`【indexedDB.open APPLY】参数：${f.map((t=>u.getTools("compressText")(JSON.stringify(t))))}`);const p=f[0];n?.({name:p,version:f[1],params:f});const d=new Proxy(Reflect.apply(t,l,f),{set:(t,i,a,l)=>["onupgradeneeded","onsuccess","onerror"].includes(i)?((s||r)&&e.console.log(`indexedDB ${p} Setting ${i} to ${u.tools.compressText(a.toString())}`),(c||n)?.(i,a,p),o&&(a=()=>{}),t[i]=a,!0):Reflect.set(t,i,a,l),get(t,r,o){i&&e.console.log(`indexedDB ${p} Getting ${r}`),(a||n)?.(r,p);try{let e=Reflect.get(t,r);return"function"==typeof e&&(e=e.bind(t)),e}catch(t){return void e.console.warn(`indexedDB ${p} Getting ${r} failed:`,t)}}});return d}}),"open",1)},intervalHandle:function(t){const e=this;"object"!=typeof t&&(t={});const n=this.memory.window,{log:r,cb:o,time:i,filter:s=(()=>!0)}=t;n.setInterval=this.getTools("setNativeFuncName")(new Proxy(n.setInterval,{apply:function(t,a,c){const u=e.cache.intervalIdx=e.cache.intervalIdx+1;if(!s||!s(...c))return;const[l,f]=c,p=l.param?JSON.stringify(l.param):e.getTools("compressText")(l.toString());if(r&&n.console.log(`【INTERVAL APPLY】增加setInterval事件，时间：${f}, 方法:${p}`),void 0!==i){if("number"!=typeof i)throw new Error("time配置如果存在值则必须是数字");return Reflect.apply(t,a,[()=>{r&&n.console.log(`【INTERVAL RUN】setInterval执行，时间：${f}，方法：${p}`),o&&o("run_before",u),l(),r&&n.console.log(`【INTERVAL RUNED】setInterval执行，时间：${f}，方法：${p}`),o&&o("run_after",u)},i||f])}return e.getTools("addInterval")(l,f)}}),"setInterval")},ovserverHandle:function(t){const e=this;"object"!=typeof t&&(t={});const n=this.memory.window,{ignore:r,newLog:o,addLog:i,runLog:s,log:a,addCb:c,runCb:u,newCb:l,cb:f,filter:p=(()=>!0)}=t;n.MutationObserver=this.getTools("setNativeFuncName")(new Proxy(n.MutationObserver,{construct:function(t,d,h){const[g]=d,y=g.param?JSON.stringify(g.param):e.getTools("compressText")(g.toString());(o||a)&&n.console.log(`【NEW OVSERVER】方法：${y}`),(l||f)?.(...d);const v=Reflect.construct(t,[async(...t)=>{var e;p&&p(...d)&&((s||a)&&n.console.log(`【RUN OVSERVER】方法：${y}`),(u||f)?.(...t[0]),r||(await(e=0,new Promise((t=>n.setTimeout(t,e)))),g(...t)))}],h);return v.observe=new Proxy(v.observe,{apply:function(t,e,r){return(i||a)&&n.console.log(`【ADD OVSERVER】方法：${y}`),(c||f)?.(...r),Reflect.apply(t,e,r)}}),v}}),"MutationObserver")},requestFileSystemHandle:function(t){"object"!=typeof t&&(t={});const e=this.memory.window,{cb:n,log:r,filter:o}=t,i=this;e.webkitRequestFileSystem&&(e.webkitRequestFileSystem=this.getTools("setFuncNative")(new Proxy(e.webkitRequestFileSystem,{apply(t,s,a){if(r&&e.console.log(`【webkitRequestFileSystem APPLY】参数：${a.map((t=>i.getTools("compressText")(JSON.stringify(t))))}`),n?.({type:a[0]?"window.PERSISTENT":"window.TEMPORARY",size:a[1],params:a}),o&&o(...a))return Reflect.apply(t,s,a)}}),"webkitRequestFileSystem",3))},requestHandle:function(t){"object"!=typeof t&&(t={});const e=this.memory.window,{log:n,cb:r}=t;e.XMLHttpRequest=new e.Proxy(e.XMLHttpRequest,{construct:(t,o,i)=>new e.Proxy(e.Reflect.construct(t,o,i),{set:(t,o,i,s)=>"function"==typeof i?e.Reflect.set(t,o,new e.Proxy(i,{apply:(t,i,s)=>(4===i.readyState&&(n&&e.console.log(`【REQUEST ${o} APPLY】链接：${xhr.responseURL}，状态码：${xhr.status}，返回数据；${xhr.responseText}`),r&&r({name:o,url:i.responseURL,status:i.status,response:i.responseText})),e.Reflect.apply(t,i,s))}),s):e.Reflect.set(t,o,i,s)})})},timeoutHandle:function(t){const e=this;"object"!=typeof t&&(t={});const n=this.memory.window,{log:r,cb:o,time:i,filter:s=(()=>!0)}=t;n.setTimeout=this.getTools("setNativeFuncName")(new Proxy(n.setTimeout,{apply:function(t,a,c){const u=e.cache.timeoutIdx=e.cache.timeoutIdx+1;if(!s||!s(...c))return;const[l,f]=c,p=l.param?JSON.stringify(l.param):e.getTools("compressText")(l.toString());if(r&&n.console.log(`【TIMEOUT APPLY】增加setTimeout事件，时间：${f}, 方法: ${p}`),void 0!==i){if("number"!=typeof i)throw new Error("time配置如果存在值则必须是数字");return Reflect.apply(t,a,[()=>{r&&n.console.log(`【TIMEOUT RUN】setTimeout执行，时间：${f}，方法：${p}`),o&&o("run_before",u),l(),r&&n.console.log(`【TIMEOUT RUNEND】setTimeout执行，时间：${f}，方法：${p}`),o&&o("run_after",u)},i||f])}return e.getTools("addTimeout")(l,f)}}),"setTimeout"),n.document.addEventListener("readystatechange",(function(){r&&n.console.log(`【READY STATE】${n.document.readyState}`)}))},windowHandle:function({...t}={}){const e=this,n=require("vm");"object"!=typeof t&&(t={});const r={win:void 0,func:void 0,context:void 0,ori:void 0,proxyRecord:new WeakMap};["Undefined","Error","Own","Win"].forEach((n=>{const r=`windowGetter${n}Keys`;if(void 0===t[r]&&(t[r]=[]),!Array.isArray(t[r]))throw new Error(`参数${r}值必须为数组请检查！`);t[r].push(...e.config[r])}));const{cb:o,parse:i=(t=>t),windowGetterUndefinedKeys:s,windowGetterErrorKeys:a,windowGetterOwnKeys:c,windowGetterWinKeys:u}=t,l=(f=t.log)&&"function"!=typeof f?(...t)=>{e.memory.window.console.log(["【sdenv window proxy】",t.join(": ")].join(""))}:f;var f;e.getTools("wrapFunc")(n,"runInContext",((t,f,p,d)=>{const h=Object.create(null);if("[object Window]"===String(p)){r.ori=p;const g={has:(t,e)=>(l&&l("has",String(e)),!s.includes(e)&&Reflect.has(r.ori,e)),deleteProperty:(t,e)=>(l&&l("deleteProperty",String(e)),Reflect.deleteProperty(r.ori,e)),ownKeys:t=>(l&&l("ownKeys"),Array.from(new Set([...Reflect.ownKeys(r.ori),...c]))),getOwnPropertyDescriptor(t,e){if(l&&l("getOwnPropertyDescriptor",String(e)),u.includes(e))return Reflect.getOwnPropertyDescriptor(t,e);const n=Reflect.getOwnPropertyDescriptor(r.ori,e)||{value:r.ori[e]};return void 0!==n.value?(void 0===t[e]&&Object.defineProperty(t,e,n),n):void 0},defineProperty:(t,e,n)=>(l&&l(`defineProperty: ${String(e)}`),Reflect.defineProperty(r.ori,e,n)),preventExtensions:t=>(l&&l("preventExtensions"),Reflect.preventExtensions(r.ori)),isExtensible:t=>(l&&l("isExtensible"),Reflect.isExtensible(r.ori)),getPrototypeOf:t=>(l&&l("getPrototypeOf"),Reflect.getPrototypeOf(r.ori)),setPrototypeOf:(t,e)=>(l&&l("setPrototypeOf"),Reflect.setPrototypeOf(r.ori,e)),get(t,e){if(l&&l("get",String(e)),u.includes(e))return r.win||(r.win=new Proxy(h,g),u.forEach((t=>{r.win[t]=r.win})),r.proxyRecord.set(r.win,!0),r.win.Function=r.func),r.win;if(!s.includes(e)){if(!Reflect.has(r.ori,e)&&a.includes(e))throw new ReferenceError(`${e} is not defined`);return Reflect.get(r.ori,e)}},set:(t,e,n)=>(l&&l("set",`${String(e)} = ${n}`),!u.includes(e)&&Reflect.set(r.ori,e,n))};r.context||(r.context=new Proxy(h,g),u.forEach((t=>{r.context[t]=r.context})),r.proxyRecord.set(r.context,!0),r.func=t("(function(){ return (function(){}).constructor })()",n.createContext(r.context)),e.getTools("setToString")(r.func.prototype),r.context.Window.constructor=r.context.Function=r.func);const y=n.createContext(r.context);return o&&o(t,y,d,p),t(i(f),y,d)}return t(f,p,d)}))}});return class{constructor(t,e=void 0){Object.assign(this,se({},ae,t||{},{tools:ir,adapt:cr})),this.setWindow(e),Vn.call(this),this.bindThis()}bindThis(){const t=this;function e(n){Object.entries(n).forEach((([r,o])=>{"function"!=typeof o?e(o):n[r]=o.bind(t)}))}["tools","adapt"].forEach((t=>{e(this[t])}))}setWindow(t){t||(window?t=window:global&&(t=global)),Object.assign(this.memory,{window:t},["eval","Function","Date","Math","setTimeout","setInterval","webkitRequestFileSystem","XMLHttpRequest","MutationObserver","addEventListener"].reduce(((e,n)=>({...e,[n]:"function"==typeof t[n]?t[n].bind(t):t[n]})),{})),this.config.isNode&&t.Window&&Object.setPrototypeOf(t.window,t.Window.prototype)}getHandle(t){const e=`${t}Handle`;if($r[e])return(...t)=>($r[e].call(this,...t),this)}getTools(t){if(ir[t])return(...e)=>ir[t].call(this,...e)}getUtils(t){if(utils[t])return(...e)=>utils[t].call(this,...e)}}}();SdenvExtend.version="V1.7.0";
